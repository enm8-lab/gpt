{region "DOCS"}
(*

**Описание работы блока**

Функциональный блок предназначен для приема, обработки и анализа аналоговых сигналов. Блок способен обрабатывать сигнал типа токовой петли в диапазоне от 4(0) до 20 мА, также сигнал напряжения в диапазоне от 1(0) до 10 В (от 1 до 5 В).

Чтобы запустить функциональный блок необходимо на параметр **[Init]** подать переменную *True*.

У блока предусмотрена возможность настройки части его параметров через вход **[FB_SETTINGS]**. Настроить можно следующие параметры:

- диапазон измерений **[ChangeRange]** – 0 - диапазон 4..20 мА (0..20 мА), 1 - диапазон 0..10 В, 2 - диапазон 1..5 В, 3 - диапазон 1..5 В (под диапазон 0..10 В) – тип данных BYTE;
- гистерезис **[Hyst]** – в процентах от указанной шкалы **[LowRange..HighRange]** – тип данных REAL;
- время сработки сигнализации уставок (отдельно для каждой) **[TIME_HH (H, L, LL)]** –тип данных TIME;
- максимальное расхождение тока (при работе в резервировании) **[PERC_OF_DISCREP]** значение в процентах – тип данных REAL;
- константу фильтра нижних частот (ФНЧ) **[FILTER_CONSTANT]** – значение в диапазоне (0; 1] (минимальное значение 0.01) – тип данных REAL. Формула следующая:

    .. hint:: Val\ :sub:`filt` \ = (1-K) * Val\ :sub:`filt` \+ K * Val\ :sub:`raw`\, где

        Val\ :sub:`filt`\ – отфильтрованное аналоговое значение;

        Val\ :sub:`raw`\ – «сырое» аналоговое значение;
- включение резервирования **[IS_REDUND]** – тип данных BOOL;
- деблокировку верхних/нижних порогов (по отдельности) **[HIGH(LOW)_DEBLOCK]** – тип данных BOOL;
- действия при неисправности **[ERROR_HANDLING]** – перечисление ENUM: 0 - KEEP_LAST_VAL (Сохранять последнее значение); 1 - SET_TO_ZERO (Устанавливать значение низа шкалы); 2 - CONTINUE_EVAL (Продолжать вычисления).

К входным рабочим параметрам блока относятся:

- уставка определения обрыва **[LoopFaultSetpoint]** – для определения обрыва значение параметра должно быть строго меньше уставки;
- уставка определения короткого замыкания **[ShortCircuitSetpoint]**– для определения короткого замыкания значение параметра должно быть строго больше уставки;
- уставка верхней шкалы измерений датчика **[HighRange]** – верхний предел измерений полевого датчика по проекту;
- уставка нижней шкалы измерений датчика **[LowRange]** – нижний предел измерений полевого датчика по проекту;
- уставка верхней аварийной сигнализации – HH, **[HighAlarm]** – для сработки сигнализации значение параметра должно быть не меньше, чем значение уставки. При этом для обратного перехода в норму необходимо, чтобы значение параметра стало строго меньше, чем значение уставки минус значение гистерезиса (см. рисунок);
- уставка верхней предупредительной сигнализации – H, **[HighWarn]** – для сработки сигнализации значение параметра должно быть не меньше, чем значение уставки. При этом для обратного перехода в норму необходимо, чтобы значение параметра стало строго меньше, чем значение уставки минус значение гистерезиса;
- уставка нижней предупредительной сигнализации – L, **[LowWarn]** – для сработки сигнализации значение параметра должно быть не меньше, чем значение уставки. При этом для обратного перехода в норму необходимо, чтобы значение параметра стало строго меньше, чем значение уставки минус значение гистерезиса;
- уставка нижней аварийной сигнализации – LL, **[LowAlarm]** – для сработки сигнализации значение параметра должно быть не меньше, чем значение уставки. При этом для обратного перехода в норму необходимо, чтобы значение параметра стало строго меньше, чем значение уставки минус значение гистерезиса;
- имитируемое значение **[ImitValue]** – значение имитации, принимает значения в диапазоне шкалы измерений датчика **[LowRange..HighRange]**;
- слово управления **[ContrWord]** – слово управления для функционального блока. Разбитовка и назначение битов расписаны в таблице.

 .. figure:: @(AI_EXMPL)
 	:scale: 25 %
	:align: center
	:alt: ЗАО "НИЦ "Инкомсистем"

	*Рисунок. Пример сработки верхней аварийной сигнализации*

К выходным рабочим параметрам блока относятся:

- слово состояния **[StatWord]** – слово состояния для функционального блока. Разбитовка и назначение битов расписаны в таблице 1 (см. ниже);
- значение сигнала в инженерных единицах **[Value]** – формируется в зависимости от режима работы резервирование/одиночный (см. ниже);
- значение сигнала в токовых единицах **[CurrentValue]** – формируется в зависимости от режима работы резервирование/одиночный (см. ниже);
- обрыв цепи **[LoopFault]** – формируется в зависимости от режима работы резервирование/одиночный (см. ниже);
- короткое замыкание **[ShortCircuit]** – формируется в зависимости от режима работы резервирование/одиночный (см. ниже);
- расхождение показаний каналов **[DiscrepancyEval]** – формируется в зависимости от режима работы резервирование/одиночный;
- неисправность модуля **[ModuleFault]** – формируется в зависимости от режима работы резервирование/одиночный (см. ниже);
- достоверность показаний датчика **[LegVal]** – формируется в зависимости от режима работы резервирование/одиночный (см. ниже);
- сработка сигнализации HH **[HighAlarmOn]** – формируется при превышении соответствующей уставки, при условии, что она включена в работу;
- сработка сигнализации H **[HighWarnOn]** – формируется при превышении соответствующей уставки, при условии, что она включена в работу;
- сработка сигнализации L **[LowWarnOn]** – формируется при превышении соответствующей уставки, при условии, что она включена в работу;
- сработка сигнализации LL **[LowAlarmOn]** – формируется при превышении соответствующей уставки, при условии, что она включена в работу;
- сработка сигнализации HH на алгоритм (блокировка) **[HighAlarmOnAlg]** – формируется при сработке соответствующей сигнализации и условии, что не включена деблокировка данного порога;
- сработка сигнализации H на алгоритм (блокировка) **[HighWarnOnAlg]** – формируется при сработке соответствующей сигнализации и условии, что не включена деблокировка данного порога;
- сработка сигнализации L на алгоритм (блокировка) **[LowWarnOnAlg]** – формируется при сработке соответствующей сигнализации и условии, что не включена деблокировка данного порога;
- сработка сигнализации LL на алгоритм (блокировка) **[LowAlarmOnAlg]** – формируется при сработке соответствующей сигнализации и условии, что не включена деблокировка данного порога.

Для связи с физическими параметрами используются (в зависимости от режима работы) следующие параметры:

- вход основного канала в кодах АЦП **[prim_Input]** – к данному входу должен быть подключен сигнал, который подключен к каналу модуля в его маппинг-таблицы;
- состояние основного модуля **[prim_ModuleNormal]** – к данному входу должен быть подключен сигнал, который отвечает за нормальное состояние модуля;
- вход резервного канала в кодах АЦП **[sec_Input]** – аналогично основному;
- состояние резервного модуля **[sec_ModuleNormal]** – аналогично основному.

Данный функциональный блок позволяет использовать его как для одиночной, так и для резервированной конфигурации. 

В одиночной конфигурации используются только параметры основного канала.

В резервированной конфигурации используются параметры и основного, и резервного каналов, но в зависимости от направления резервирования может измениться их приоритет:

- прямое резервирование:
    в работе принимают участие оба канала, в приоритете основной канал, поэтому если основной канал восстановится после неисправности, на выход **[Value]** и **[CurrentValue]** будет выдаваться его значение. В случае расхождения тока более, чем указанный интервал **[PERC_OF_DISCREP]** будет сформирована сигнализация о расхождении **[DiscrepancyEval]**. Итоговые значения **[LoopFault]**, **[ShortCircuit]**, **[ModuleFault]** формируются как произведения (логическое И) соответствующих сигналов основного и резервного каналов, а **[LegVal]** как сумма (логическое ИЛИ);
- обратное резервирование:
    в работе принимают участие оба канала, в приоритете резервный канал, поэтому если резервный канал восстановится после неисправности, на выход **[Value]** и **[CurrentValue]** будет выдаваться его значение. В случае расхождения тока более, чем указанный интервал **[PERC_OF_DISCREP]** будет сформирована сигнализация о расхождении **[DiscrepancyEval]**. Итоговые значения **[LoopFault]**, **[ShortCircuit]**, **[ModuleFault]** формируются как произведения (логическое И) соответствующих сигналов основного и резервного каналов, а **[LegVal]** как сумма (логическое ИЛИ);
- только основной канал:
    работа блока аналогична одиночному режиму, все значения берутся с основного канала;
- только резервный канал:
    работа блока аналогична одиночному режиму, все значения берутся с резервного канала.
*)
{endregion}

{attribute 'hide_all_locals'}
FUNCTION_BLOCK ICS_AI	(* Модуль обработки AI *)
VAR_INPUT
	Init				: BOOL;		//Инициализация контроллера
	{attribute 'pingroup' := 'Битовые маски'}
	{attribute 'displaymode':='binary'}	
	ContrWord	:WORD;	(*Слово управления: 
	(b0) - СВОБОДНО;  
	(b1) - Включить режим имитации; 
	(b2) - Деблокировать;
	(b3) - Отключить сигнализацию HH;
	(b4) - Отключить сигнализацию H;
	(b5) - Отключить сигнализацию L;
	(b6) - Отключить сигнализацию LL;
	...
	(b12) - Включить режим прямого резервирования;
	(b13) - Включить режим обратного резервирования;
	(b14) - Включить в работу только основной канал;
	(b15) - Включить в работу только резервный канал;
	*)	
	{attribute 'pingroup' := 'Основной канал'}
	prim_Input			: UINT;	//Вход основного канала в кодах АЦП
	{attribute 'pingroup' := 'Основной канал'}
	prim_ModuleNormal	: BOOL; //Состояние основного модуля
	{attribute 'pingroup' := 'Резервный канал'}	
	sec_Input			: UINT;	//Вход резервного канала в кодах АЦП	
	{attribute 'pingroup' := 'Резервный канал'}	
	sec_ModuleNormal	: BOOL; //Состояние резервного модуля
	{attribute 'pingroup' := 'Настройка блока'}
	LoopFaultSetpoint	: REAL;	//Порог для определения обрыва
	{attribute 'pingroup' := 'Настройка блока'}
	ShortCircuitSetpoint: REAL;	//Порог для определения КЗ
	{attribute 'pingroup' := 'Настройка блока'}
	HighRange			: REAL;	//Верхнее значение диапазона датчика
	{attribute 'pingroup' := 'Настройка блока'}
	LowRange			: REAL;	//Нижнее значение диапазона датчика
	{attribute 'pingroup' := 'Пороги'}
	HighAlarm			: REAL;	//Уставка сигнализации HH
	{attribute 'pingroup' := 'Пороги'}
	HighWarn			: REAL;	//Уставка сигнализации H
	_kFilter: REAL;
	_fltInitDone : BOOL;
	
	{attribute 'pingroup' := 'Пороги'}
	LowWarn				: REAL;	//Уставка сигнализации L
	{attribute 'pingroup' := 'Пороги'}
	LowAlarm			: REAL;	//Уставка сигнализации LL
	{attribute 'pingroup' := 'Пороги'}
	Hmask				: BOOL;	//Маскирование сигнализации HH и H
	{attribute 'pingroup' := 'Пороги'}
	Lmask				: BOOL;	//Маскирование сигнализации LL и L
	{attribute 'pingroup' := 'Значение'}
	ImitValue			: REAL;	//Значение имитации, инж. ед.	
	{attribute 'pingroup' := 'Настройка блока'}	
	FB_SETTINGS 		: AI_SETTINGS; (*Настройки блока:
	ChangeRange - Диапазон: 0 - диапазон 4..20 мА (0..20 мА), 1 - диапазон 0..10 В, 2 - диапазон 1..5 В, 3 - диапазон 1..5 В (под диапазон 0..10 В);
	Hyst -  Гистерезис;
	TIME_HH	- Время задержки для формирования сигнализации HH;
	TIME_H - Время задержки для формирования сигнализации H;
	TIME_L - Время задержки для формирования сигнализации L;
	TIME_LL - Время задержки для формирования сигнализации LL;
	PERC_OF_DISCREP - Максимальное значние расхождения тока, %;
	ERROR_HANDLING - Что делать при возникновении неисправности: 0 - KEEP_LAST_VAL (Сохранять последнее значение); 1 - SET_TO_ZERO (Устанавливать значение низа шкалы); 2 - CONTINUE_EVAL (Продолжать вычисления);
	FILTER_CONSTANT - Конастанта фильтра НЧ (0; 1] (минимальное значение 0.01);
	IS_REDUND - Блок используется для резервирования;
	HIGH_DEBLOCK - Деблокировать верхние сигнализации H, HH (для газоанализатора);
	LOW_DEBLOCK - Деблокировать нижние сигнализации L, LL (для газоанализатора);
*)
END_VAR
VAR_OUTPUT
	{attribute 'hide'}
	RepairState 	: BOOL; //Блок выведен в ремонт
	ImitState		: BOOL;	//Режим имитации
	DeblockState	: BOOL; //Ручное управление блоком (деблокировка)	
	{attribute 'pingroup' := 'Битовые маски'}
	{attribute 'displaymode':='binary'}
	StatWord		: WORD;		(*Состояние для ВУ: 
	(b0) - СВОБОДНО;
	(b1) - Деблокирован;
	(b2) - Обрыв цепи (итоговое значение);
	(b3) - Достоверность показаний датчика (итоговое значение);
	(b4) - Короткое замыкание (итоговое значение);
	(b5) - Неисправность модуля (итоговое значение);
	(b6) - Сработка сигнализации HH;
	(b7) - Сработка сигнализации H; 
	(b8) - Сработка сигнализации L; 
	(b9) - Сработка сигнализации LL;
	(b10) - Сигнализация HH включена;
	(b11) - Сигнализация H включена;
	(b12) - Сигнализация L включена;
	(b13) - Сигнализация LL включена;
	(b14) - Режим имитации;
	(b15) - Ошибка в уставках;		
	*)
	{attribute 'pingroup' := 'Битовые маски'}
	{attribute 'displaymode':='binary'}
	StatWordRedund	: WORD; (*Состояние резервирования: 
	(b0) - Режим прямого резервирования;
	(b1) - Режим обратного резервирования;
	(b2) - Только основной канал;
	(b3) - Только резервный канал;
	(b4) - Обрыв цепи (основной канал);
	(b5) - Достоверность показаний канала (основной канал);
	(b6) - Короткое замыкание (основной канал);
	(b7) - Неисправность модуля (основной канал);
	(b8) - СВОБОДНО;
	(b9) - Обрыв цепи (резервный канал);
	(b10) - Достоверность показаний канала (резервный канал);
	(b11) - Короткое замыкание (резервный канал);
	(b12) - Неисправность модуля (резервный канал);		
	(b13) - СВОБОДНО;
	(b14) - СВОБОДНО;
	(b15) - Расхождение показаний каналов;
	*)	
	{attribute 'pingroup' := 'Значение'}
	Value				: REAL;		//Значение сигнала, инж. ед. (итоговое значение)
	{attribute 'pingroup' := 'Значение'}
	CurrentValue		: REAL;		//Значение сигнала, ток. ед. (итоговое значение)
	{attribute 'pingroup' := 'Диагностика'}
	LoopFault			: BOOL;		//Обрыв цепи (итоговое значение)
	{attribute 'pingroup' := 'Диагностика'}
	ShortCircuit		: BOOL;		//Короткое замыкание (итоговое значение)
	{attribute 'pingroup' := 'Диагностика'}
	DiscrepancyEval		: BOOL;		//Расхождение показаний каналов
	{attribute 'pingroup' := 'Диагностика'}
	ModuleFault			: BOOL;		//Неисправность модуля (итоговое значение)
	{attribute 'pingroup' := 'Диагностика'}
	LegVal				: BOOL;		//Достоверность показаний датчика (итоговое значение)
	{attribute 'pingroup' := 'Пороги'}
	HighAlarmOn			: BOOL;		//Сработка сигнализации HH
	{attribute 'pingroup' := 'Пороги'}
	HighWarnOn			: BOOL;		//Сработка сигнализации H
	{attribute 'pingroup' := 'Пороги'}
	LowWarnOn			: BOOL;		//Сработка сигнализации L
	{attribute 'pingroup' := 'Пороги'}
	LowAlarmOn			: BOOL;		//Сработка сигнализации LL
	{attribute 'pingroup' := 'Пороги'}
	HighAlarmOnAlg		: BOOL;		//Сработка сигнализации HH на алгоритм (блокировка)
	{attribute 'pingroup' := 'Пороги'}
	HighWarnOnAlg		: BOOL;		//Сработка сигнализации H на алгоритм (блокировка)
	{attribute 'pingroup' := 'Пороги'}
	LowWarnOnAlg		: BOOL;		//Сработка сигнализации L на алгоритм (блокировка)
	{attribute 'pingroup' := 'Пороги'}
	LowAlarmOnAlg		: BOOL;		//Сработка сигнализации LL на алгоритм (блокировка)
	{attribute 'pingroup' := 'Основной канал'}
	prim_Value			: REAL;		//Значение сигнала, инж. ед. (основной канал)
	{attribute 'pingroup' := 'Основной канал'}
	prim_CurrentValue	: REAL;		//Значение сигнала, ток. ед. (основной канал)
	{attribute 'pingroup' := 'Основной канал'}
	prim_ModuleFault	: BOOL;		//Неисправность модуля (основной канал)
	{attribute 'pingroup' := 'Основной канал'}
	prim_LoopFault		: BOOL;		//Обрыв цепи (основной канал)
	{attribute 'pingroup' := 'Основной канал'}
	prim_ShortCircuit	: BOOL;		//Короткое замыкание (основной канал)
	{attribute 'pingroup' := 'Основной канал'}
	prim_LegVal			: BOOL;		//Достоверность показаний датчика (основной канал)
	{attribute 'pingroup' := 'Резервный канал'}
	sec_Value			: REAL;		//Значение сигнала, инж. ед. (резервный канал)
	{attribute 'pingroup' := 'Резервный канал'}
	sec_CurrentValue	: REAL;		//Значение сигнала, ток. ед. (резервный канал)
	{attribute 'pingroup' := 'Резервный канал'}
	sec_ModuleFault		: BOOL;		//Неисправность модуля (резервный канал)
	{attribute 'pingroup' := 'Резервный канал'}
	sec_LoopFault		: BOOL;		//Обрыв цепи (резервный канал)
	{attribute 'pingroup' := 'Резервный канал'}
	sec_ShortCircuit	: BOOL;		//Короткое замыкание (резервный канал)
	{attribute 'pingroup' := 'Резервный канал'}
	sec_LegVal			: BOOL;		//Достоверность показаний датчика (резервный канал)
	{attribute 'pingroup' := 'Настройка блока'}
	FB_ERR				: BOOL; 	//Ошибка блока
	{attribute 'pingroup' := 'Настройка блока'}	
	ERROR_STATE	: STRING; (*Ошибки функционального блока
0 - NO_ERROR (Ошибок нет);
1 - NON_INIT_ERR (Не инициализирован блок);
101 - NON_SCALE_ERR (Не выставлена шкала);
102 - CHG_RNG_ERR (Некорректно указана настройка ChangeRange);
1001 - FAULT_SETPOINTS_ERR (Ошибка в уставка КЗ и ОЦ);
1002 - ALG_SETPOINTS_ERR (Ошибка в аварийных и предупредительных уставках);
1003 - ERR_HANDLE_ERR (Некорректно указана настройка ERR_HANDLE);
1004 - SCALE_ERR (Нижний порог шкалы выше чем верхний);
*)
{attribute 'pingroup' := 'Настройка блока'}	
	CHAN_REG_STATE	: STRING; (*Режимы работы с каналами:
1 - DIRECT_RED (включено прямое резервирование (1 канал - основной, 2 - резервный) (по умолчанию));
2 - REVERSE_RED (включено обратное резервирование (1 канал - резервный, 2 - основной));
4 - FIRST_CHANNEL (включен только основной канал);
8 - SECOND_CHANNEL (включен только резервный канал);
*)
	{attribute 'pingroup' := 'Настройка блока'}
	EVAL_STATE 	: STRING; (*Как высчитываются показания
0 - REDUND (Резервирование);
1 - FIRST_CHANNEL (Показания с первого канала);
2 - SECOND_CHANNEL (Показания со второго канала);
3 - DISCREPANCY (Расхождение показаний на каналах);
-1 - BOTH_FALSE (Оба канала в ошибке);
*)
END_VAR

VAR
	_old_value 				: REAL;	// Предыдущее значение
	_prim_old_value 		: REAL;	// Предыдущее значение
	_sec_old_value 			: REAL;	// Предыдущее значение
	_value					: REAL;
	_prim_value				: REAL;
	_sec_value				: REAL;
	
	_changerangeisvalid 	: BOOL; // Параметры диапазона установлены правильно
	_highrawrange			: UINT; // Верхнее токовое значение в кодах АЦП
	_lowrawrange 			: UINT;	// Нижнее токовое значение в кодах АЦП
	_highcurrange			: REAL; // Верхнее токовое значение в токовых единицах
	_lowcurrange 			: REAL;	// Нижнее токовое значение в токовых единицах
	_unitary_curval			: REAL; // Единичное токовое значение в кодах АЦП
	
	_scaleisvalid			: BOOL; // Параметры шкалы установлены правильно
	_paramsisvalid			: BOOL; // Параметры блока установлены правильно
	
	_hh_alarmfault			: BOOL; 
	_h_alarmfault			: BOOL; 
	_l_alarmfault			: BOOL; 
	_ll_alarmfault 			: BOOL;
	_ton_hh 				: Standard.TON(); 
	_ton_h 					: Standard.TON(); 
	_ton_l 					: Standard.TON(); 
	_ton_ll 				: Standard.TON();
	
	_ton_discrepancy		: Standard.TON();
	_ton_time_discrepancy	: TIME := T#1S;
	
	_prim_filtered_input 	: REAL;	// Отфильтрованное значение на основном канале
	_sec_filtered_input 	: REAL;	// Отфильтрованное значение на резервном канале
	
	// Формирование ошибок блока
	_no_error 				: BOOL; // Ошибок нет
	_non_init_err 			: BOOL; // Не инициализирован блок
	_fault_setpoints_err 	: BOOL;	// Ошибка в уставка КЗ и ОЦ
	_non_scale_err 			: BOOL; // Не выставлена шкала
	_scale_err				: BOOL; // Нижний порог шкалы выше чем верхний
	_alg_setpoints_err 		: BOOL; // Ошибка в аварийных и предупредительных уставках	
	_err_handle_err 		: BOOL; // Некорректно указана настройка ERR_HANDLE
	_chg_rng_err 			: BOOL; // Некорректно указана настройка ChangeRange
	
	// Локальные пременные для упрощения логических выражений
	_imit_fault 	: BOOL; // Имитация или Неправильно проставлены уставки для ОЦ и КЗ или Отказ модуля
	_prim_sec_LegVal 	: BOOL; // Оба канала дают достоверные значения
	_discrepancy 		: BOOL; // Расхождение показаний
	
	// Локальные пременные для упрощения математических выражений
	_perc_discrepancy_val 	: REAL; // Процент расхождения двух сигналов
	_value_hyst				: REAL; // Гистерезис	
	
	// Разбитовка ContrWord
	_imit 			: BOOL;		// (b1) - Включить режим имитации;
	_deblock 		: BOOL;		// (b2) - Деблокировать;
	_HH_off 		: BOOL;		// (b3) - Отключить сигнализацию HH;
	_H_off 			: BOOL;		// (b4) - Отключить сигнализацию H;
	_L_off 			: BOOL;		// (b5) - Отключить сигнализацию L;
	_LL_off 		: BOOL;		// (b6) - Отключить сигнализацию LL;
	_direct_red 	: BOOL;		// (b12) - Включить режим прямого резервирования;
	_reverse_red 	: BOOL;		// (b13) - Включить режим обратного резервирования;
	_first_channel 	: BOOL;		// (b14) - Включить в работу только основной канал;
	_second_channel : BOOL;		// (b15) - Включить в работу только резервный канал;
	
	_red_eval 	: RED_EVAL; 	// Как высчитываются показания
	_error 		: ERRORS;		// Ошибки функционального блока
	
	_setpointsneispravfault 	: BOOL; // Ошибка уставок несиправности (Они равны или уставка ОЦ выше уставки КЗ)
	_setpointalarmfault 		: BOOL; // Ошибка уставок сигнализаций
	
	//Сырые значения
	_prim_raw_currentvalue		: REAL;		// Сырое значение сигнала, ток. ед. (основной канал)
	_sec_raw_currentvalue		: REAL;		// Сырое значение сигнала, ток. ед. (резервный канал)
	
	_CH_REG_STATE 				: CH_REG_STATE; 	(*Режимы работы с каналами: 
1 - включено прямое резервирование (1 канал - основной, 2 - резервный) (по умолчанию);
2 - включено обратное резервирование (1 канал - резервный, 2 - основной);
4 - включен только основной канал;
8 - включен только резервный канал;
*)
END_VAR

ContrWordAct();		// Разбитовка ContrWord'а
Faults(); 			// Ошибки
Filtration();		// Фильтрация
Main(); 			// Обработка выходных инж. ед. и ток. ед.
Alarms();			// Обработка блокировок
Out();				// Вывод данных на верхний уровень
String_msg();		// Формирование ошибок блока 